//Restrict Public IP address for compute VM instance
import "tfplan-functions" as tfplan

allComputeInstances = tfplan.find_resources("google_compute_instance")

status = true

for allComputeInstances as _, rc {
	if (rc.change.after contains "network_interface")	{
		if (rc.change.after.network_interface contains "access_config") {
			status = false
			print ("Policy Validation - Restricting Public IP Access for Compute Instance")    
		}	
	}
	
}



main = rule {
	status
}